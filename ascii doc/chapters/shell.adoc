//-----------------------------------------------------------------------------
== The Shell
[[shl]]
The Shell is foundational to so many parts of securing computing devices and 
their networks. Intimidating and alluring (like most symbols enshrined by film
makers), understanding the shell can make or break one's ability to solve 
challenges in a capture-the-flag competition like picoCTF.

To be transparent, I (LT) am still learning a lot about the shell, and I'm
just about 10 years into it right now! This is an encouragement - anyone 
curious enough to jump into rabbitholes here and there is always going to have
opportunities to learn more about an amazing tool like the shell. But rest 
assured, I was proficient in the shell long ago and it does not take very much
time before the shell starts working for *you*.

Next up, what is that mystique unique to the hacker and their shell?

//-----------------------------------------------------------------------------
=== Symbol of the Hacker
[[shl-symbol-of-the-hacker]]
//TODO punt :put animation here of terminal prompt w blinking cursor!
//TODO punt :consider using hacker typer to demonstrate "flow of info"

A blank, black screen and blinking cursor. Lines and lines of scrolling text
and someone in front of that screen who seemingly understands an
incomprehensible flow of information. That is the shell.

The shell has many other names: the terminal, the command prompt, bash...
Powershell, if you're looking at Windows and feeling blue. Each name has its
own nuances. But that doesn't matter right now. What matters is that there is
the interface to computing devices that nearly all people use, and then there
is the shell.

If you've come here to get a shell and don't care for much else, then you
should skip to the <<shl-get-a-shell,Get a Shell>> section. Be warned that the
shell is more powerful than the usual way of interacting with a device.
Deleting files is permanent in the shell, any file can be accessed at any
moment in the shell, and hopefully it's not far fetched to assert that those
two things are a dangerous combination.

//-----------------------------------------------------------------------------
=== Got Shell?
[[shl-got-shell]]

Using a computer or smart device happens in 1 of 2 ways:

1. Using a pointer such as a mouse, touchpad or finger to select apps, files,
   or buttons
2. Using keys on a keyboard to enter simple or complex commands (the Shell)

Thankfully, there are TLA's (Three Letter Acronyms) for both of the methods
described above:

1. GUI. Pronounced "gooey," stands for Graphical User Interface
2. CLI. Sounded out: "See-El-Eye," stands for Command Line Interface

These acronyms are pretty good as far as acronyms go. We will refer to the
shell by many names, perhaps sometimes even by the CLI initialism. The GUI
doesn't have as nice of a name as the shell, so we will probably use GUI to
briefly refer to the interface that everyone knows about on computing devices
that is driven by a pointer on a screen.

Below is a screenshot of a shell after successful login and before the user has
typed in any commands:

[[first-look,First look at a new shell]]
.The shell waiting for a command
[.text-center]
image::images/shl-1-first-look-shell.png[]

In the picture above, there is a lot of empty space, and even the line of text
that exists, does not provide a lot of clarity. The situation is simpler than
how it looks. There are only 3 pieces of information in the screenshot above,
and you would likely recognize at least one of them if it were *you* who logged
on:

// TODO ssp^ punt :
// implement simple mock terminal to provide an interactive, fun quiz, that
// starts to build confidence in shell looks good: https://terminal.jcubic.pl/
// TODO rn :
// do footnotes for answers

From left to right in the shell command line prompt:

1. What does `Q0h313th` mean?
   * Answer: https://gist.github.com/syreal17/a000b3ac491b80bfabb6ab80491b66e5
2. What does `pico-2019-shell1` mean?
   * Answer: https://gist.github.com/syreal17/2152a545457f7f83a11006139e5a04f1
3. What does `~` mean?
   * Answer: https://gist.github.com/syreal17/8b4bdf7bd0b35a7196b73c02c31c0ec2
4. What does `$` mean?
   * Answer: https://gist.github.com/syreal17/dc1340fef44be3dc59819e3379c3fe28
// TODO punt :
// this merits further exposition for the curious.. it'd be fun to have a
// little rabbit icon to click on to go down rabbitholes (maybe like to good
// Google-Fu??)

In terms of raw power, Q0h313th could delete every file they own on this
machine with one command. That's almost never desireable, and I will wait to
show this command until there is something useful and desireable to do with it.
In terms of useful power, Q0h313th could create a copy of an entire website for
use when there is no accessible WiFi. That's using the command `wget`.

Now let's talk about *getting* a shell!

//-----------------------------------------------------------------------------
=== Get a Shell
[[shl-get-a-shell]]
Cybersecurity is a topic that is most deeply learned by listening *and* doing.
For this reason, I advise you to create a picoCTF 2019 account at this time if
you have not already. Beyond providing 120+ security challenges in helpful
learning ramps, every picoCTF 2019 account gets a user on a Linux server, which
can only be accessed with a _shell_. 

A note on the structure of my (LT's) chapters: many times I will provide a high
level tutorial for a task and also a step by step walkthrough for the same
task.  This is my attempt at accomodating different learning styles, different
levels of experience or whatever else.  Typically, the high level walkthrough
is more for learners who already know the basics but need a refresher or need a
reminder about the particulars when it comes to this Primer. The step by step
walkthrough is more for learners who have never ventured in a particular sort
of task before. Of course, you must choose your own path here, but the safest
bet may be to read the high level walkthrough but actually put hands to
keyboard for the step by step walkthrough.

==== High level tutorial
. *Gain access to a practice shell*
.. Register for a picoCTF 2019 account
  * Click link in email that is sent to registered email address
.. Register account on picoCTF 2019 shell server
... Log in once to create account on shell server
   * Only required for first login for your account
... Reconnect
... Log in again to get a shell

==== Step by Step Walkthrough
//TODO punt : turn bold text into hyperlinks in this section
*Register for a picoCTF 2019 account at the link below.* You will need to
validate the email address you provide by clicking on a link that is sent to
it.

https://2019game.picoctf.com/

After successfully registering, a web shell can be accessed at the URL below.
*Use the same  user name and password that you registered on the picoCTF 2019
website to log into the shell at the link below* (or in the "Shell" tab in the
picoCTF 2019 website) For the sake of security, you will not see your password
as you type it in. *You will log in twice.* This is only for your first log
in.

https://2019game.picoctf.com/shell

You will know you've successfully logged into the shell if you see a screen
similar to this:

[[pico-successful-login,Fresh shell on pico shell server]]
.Lots of extra info! Try the `clear` command!
[.text-center]
image::images/shl-2-pico-motd-login.png[]

Not as sterile as the empty shell I pictured <<first-look,here>>. However, if
you type `clear` and press enter, it will be quite pristine! All of the info
that is pictured directly above is mostly for system administrators 
(sysadmins). You can safely ignore it.


==== Debrief
Congratulations (esp. if this is your first time staring at a command prompt)!
The next section focuses on demystifying the shell by relating its usage to
devices you've probably already used for years; and if not, you'll join the
ranks of those whose first language is Shell.


//-----------------------------------------------------------------------------
=== GUI-fu to Shell-fu
[[shl-gui-fu-to-shell-fu]]
Our first language as children, whether Spanish, English or anything else
primarily for communication with other humans, likely took little conscious
effort on our part. For anyone who has learned a second language, it was quite
the opposite: very little - if anything - came naturally. Learning Shell for
someone who has only "spoken" GUI is like learning a second language. This is
good news and bad news. The good news is that Shell and GUI are languages for
something you've been using for probably years, but the bad news is there is a
whole new vocabulary with only a handful of cognates (words that sound and mean
the same in both langauges) here and there.

==== The Basics
The basic computer operations that everyone is familiar with in GUI's can
easily be done in the shell as well. Here's some of the most common operations
for anyone using a computing device: 

.Basic computer operations
|===
|Operation |GUI action |Shell action |Shell example |Note

|Start app
|Click or touch icon of app
|Type name of app and press enter
|`$ date`
|Pressing the Enter key sends the command to the shell to run and return.

|Open file
|Browse to file, click
|Use `cat` app to print file
|`$ cat ~/my-file.txt`
|`cat` displays all text in a file.

|Download app
|Browse app store, click
|Use `apt` to download app
|`$ apt install chessx`
|Install ChessX game. The hard part was finding a relevant package name.
|===

As the table above shows, using a GUI involves browsing and clicking, while
using a shell involves knowing a good app to use. Google has made finding the
right app for a shell interface much easier than it was years ago. As always
for CTF's, Google is your friend! However, more direct resources can be even
more helpful, such as this website below that quickly explains shell commands:

https://explainshell.com/explain?cmd=date

However, things do not always go as planned. The next section deals with
those sorts of situations that inevitably arise.

==== What the Shell!?
[[shl-what-the-shell]]
//learning curve with the shell, dealing with complexity, errors and lots of 
//typing

//TODO: add links to terminal cheat sheets
//TODO: emphasize shortcuts, man & Google fu

//TODO:consider wrapping up first pass of this chapter by leaning on what
//exists in Marty's learning guides
//TODO :==== Common Tasks
//      such as editing a document (nano!) (for making source code)
//      creating code (simple shell script to make a task solution permanent)
